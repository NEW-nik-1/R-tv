<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TV / Radio / Games — Single File Interface</title>

  <style>
    /* --- Общие стили --- */
    :root {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    }
    html, body {
      overflow: hidden; /* отключаем скроллинг основной страницы */
      height: 100%;
      margin: 0;
      padding: 0;
    }
    body {
      background: url('background.jpg') no-repeat center center fixed;
      background-size: cover;
      color: #e6eef8;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;

      /* Уменьшаем масштаб всей страницы */
      transform: scale(0.8);
      transform-origin: 0 0;
      width: 125vw;
      height: 125vh;
      min-height: 100vh;
    }

    /* --- Хедер с вкладками --- */
    header {
      display: flex;
      justify-content: center;
      gap: 20px;
      padding: 20px;
      background: rgba(11, 18, 32, 0.8); /* прозрачный фон */
      align-items: center;
      width: 100%;
      max-width: 820px;
      box-sizing: border-box;
    }

    /* Стили кнопок вкладок */
    button.tab {
      background: linear-gradient(180deg,#3a6ea5,#224566);
      border: 2px solid #1b2b3a;
      color: #fff;
      padding: 12px 24px;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
      font-weight: bold;
      box-shadow: 0 4px #142738, 0 6px 10px rgba(0,0,0,.6);
      transition: all .2s ease;
    }
    button.tab:hover { /* эффект наведения */
      transform: translateY(-2px);
      box-shadow: 0 6px #142738, 0 8px 14px rgba(0,0,0,.6);
    }
    button.tab:active { /* эффект нажатия */
      transform: translateY(2px);
      box-shadow: 0 2px #142738, 0 4px 8px rgba(0,0,0,.6);
    }
    button.tab.active { /* активная вкладка */
      background: linear-gradient(180deg,#4b90d0,#32628c);
    }

    /* --- Основной контейнер контента --- */
    main {
      padding: 18px;
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
      max-width: 820px;
      box-sizing: border-box;
      gap: 12px;
    }

    /* --- ТВ iframe --- */
    #tv-iframe-container {
      display: none; /* скрыт по умолчанию */
      border-radius: 10px;
      overflow: hidden;
      border: 1px solid rgba(34, 50, 70, 0.5);
      width: 100%;
      max-width: 590px;
      height: 780px;
    }
    #tv-iframe {
      width: 100%;
      height: 100%;
    }

    /* --- Радио --- */
    #radio-player {
      display: none; /* скрыт по умолчанию */
      padding: 10px;
      background: rgba(7, 16, 24, 0.5);
      border-radius: 10px;
      border: 1px solid rgba(33, 50, 67, 0.5);
      width: 100%;
      max-width: 800px;
      display: flex;
      flex-direction: column;
      gap: 12px;
      box-sizing: border-box;
      align-items: center;
    }
    #radio-controls {
      width: 100%;
      display: flex;
      justify-content: center;
    }
    #radio-audio {
      width: 700px;
      max-width: 100%;
      box-sizing: border-box;
      margin-bottom: 4px;
    }
    #radio-list {
      max-height: 500px; /* увеличенная высота списка радиостанций */
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-top: 8px;
    }

    /* Стили радио-каналов */
    #channels {
      display: flex;
      flex-direction: column;
      gap: 8px;
      width: 100%;
    }
    .channel {
      padding: 12px 16px;
      background: rgba(14, 35, 50, 0.55);
      color: #e6eef8;
      font-size: 16px;
      border-radius: 6px;
      border: 1px solid rgba(21, 50, 72, 0.5);
      cursor: pointer;
      transition: background-color 0.2s,color 0.2s;
      user-select: none;
      text-align: center;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    .channel:hover { /* эффект наведения */
      background-color: rgba(34, 68, 102, 0.7);
      color: #fff;
    }
    .channel.selected { /* выбранный канал */
      background-color: rgba(42, 107, 154, 0.7);
      color: #fff;
      border-color: rgba(42, 107, 154, 0.8);
    }

    /* --- Игры --- */
    #games-overlay {
      display: none; /* скрыт по умолчанию */
      padding: 12px;
      background: rgba(7, 16, 24, 0.5);
      border-radius: 10px;
      border: 1px solid rgba(33, 50, 67, 0.5);
      max-height: 600px;
      width: 400px;
      overflow: hidden;
      flex-direction: column;
    }
    #games-list {
      flex: 1;
      height: 750px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .game-item { /* каждая игра */
      padding: 14px 16px;
      background: rgba(14, 35, 50, 0.55);
      border-radius: 8px;
      cursor: pointer;
      border: 1px solid rgba(21, 50, 72, 0.5);
      text-align: center;
      display: flex;
      justify-content: center;
      align-items: center;
      font-size: 18px;
      color: #fff;
      user-select: none;
      transition: background-color 0.3s ease;
    }
    .game-item:hover { /* эффект наведения */
      background: rgba(14, 35, 50, 0.7) !important;
      color: #fff !important;
      cursor: pointer;
    }

    /* --- Окно игры --- */
    #game-window {
      display: none;
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 720px;
      height: 480px;
      background: rgba(7, 16, 24, 0.5);
      border: 1px solid rgba(41, 64, 80, 0.5);
      border-radius: 10px;
      box-shadow: 0 12px 40px rgba(2, 7, 14, 0.7);
      overflow: hidden;
      z-index: 999;
    }
    #game-header { /* заголовок окна игры с кнопками управления */
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 6px 8px;
      background: linear-gradient(180deg, rgba(11, 26, 36, 0.8), rgba(7, 32, 43, 0.8));
      gap: 8px;
    }
    #game-title {
      font-size: 14px;
    }
    #game-controls {
      display: flex;
      gap: 6px;
    }
    .gbtn { /* кнопки управления окном игры */
      background: rgba(14, 41, 54, 0.8);
      border: 0;
      padding: 6px 8px;
      border-radius: 6px;
      cursor: pointer;
      color: #bfe1ff;
    }
    #game-iframe {
      width: 100%;
      height: calc(100% - 40px); /* вычитаем высоту заголовка */
      border: 0;
    }
    #game-window.minimized { /* свернутое окно */
      height: 42px;
      width: 260px;
      left: 0;
      bottom: 0;
      top: auto;
      transform: none;
    }
    #game-window.fullscreen { /* полноэкранное окно */
      position: fixed;
      left: 0;
      top: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100%;
      border-radius: 0;
      transform: none;
    }

    /* --- Кнопка и модальное окно помощи --- */
    #help-main-btn { /* кнопка справки в хедере */
      width: 36px;
      height: 36px;
      border-radius: 50%;
      border: 2px solid rgba(27, 43, 58, 0.5);
      background: rgba(34, 69, 102, 0.8);
      color: #fff;
      font-weight: bold;
      cursor: pointer;
      box-shadow: 0 3px 8px rgba(0, 0, 0, 0.5);
      margin-left: 8px;
    }
    #help-main-btn:hover {
      background: rgba(47, 107, 156, 0.9);
    }
    #help-modal { /* модальное окно справки */
      position: fixed;
      left: 0;
      top: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.7);
      display: none; /* скрыто по умолчанию */
      align-items: center;
      justify-content: center;
      z-index: 2000;
    }
    #help-content {
      background: rgba(15, 30, 44, 0.9);
      color: #fff;
      padding: 20px;
      max-width: 600px;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.6);
      max-height: 80vh;
      overflow-y: auto;
    }
    #close-help {
      margin-top: 15px;
      padding: 10px 20px;
      cursor: pointer;
      background: rgba(42, 107, 154, 0.9);
      color: #fff;
      border: none;
      border-radius: 8px;
    }

    /* --- Нижний текст --- */
    #bottom-text {
      padding: 20px 20px;
      background: transparent;
      color: #FFE2B7;
      font-size: 15px;
      text-align: left;
      width: 100%;
      max-width: 820px;
      box-sizing: border-box;
      margin: 0 auto 10px auto;
    }

    /* --- Стилизация скроллбаров --- */
    #radio-list::-webkit-scrollbar,
    #games-list::-webkit-scrollbar {
      width: 12px;
    }
    #radio-list::-webkit-scrollbar-track,
    #games-list::-webkit-scrollbar-track {
      background: transparent;
    }
    #radio-list::-webkit-scrollbar-thumb,
    #games-list::-webkit-scrollbar-thumb {
      background-color: #063971;
      border-radius: 6px;
      border: 3px solid transparent;
      background-clip: content-box;
    }
    #radio-list,
    #games-list {
      scrollbar-width: thin;
      scrollbar-color: #063971 transparent;
    }
  </style>
</head>
<body>
  <!-- --- Хедер с вкладками --- -->
  <header>
    <button id="btn-tv" class="tab">ТВ</button>
    <button id="btn-radio" class="tab">РАДИО</button>
    <button id="btn-games" class="tab">ИГРЫ</button>
    <button id="help-main-btn" title="Инструкция">?</button>
  </header>

  <!-- --- Основной контент --- -->
  <main>
    <!-- ТВ iframe контейнер -->
    <section id="tv-iframe-container">
      <iframe id="tv-iframe" src="https://smotret.tv/" width="500" height="300" frameborder="0" allowfullscreen title="Смотреть ТВ"></iframe>
    </section>

    <!-- Радио плеер -->
    <section id="radio-player">
      <div id="radio-controls">
        <audio id="radio-audio" controls></audio>
      </div>
      <div id="radio-list">
        <div id="channels"></div> <!-- контейнер кнопок каналов -->
      </div>
    </section>

    <!-- Игры -->
    <section id="games-overlay">
      <div id="games-list"></div>
    </section>
  </main>

  <!-- --- Окно игры --- -->
  <div id="game-window" aria-hidden="true">
    <div id="game-header">
      <div id="game-title">Игра</div>
      <div id="game-controls">
        <button id="minimize-btn" class="gbtn">▽</button>
        <button id="restore-btn" class="gbtn" style="display:none">△</button>
        <button id="fs-enter" class="gbtn">❏</button>
        <button id="fs-exit" class="gbtn" style="display:none">❏ (windowed)</button>
        <button id="help-btn" class="gbtn" title="Звук игры отключается в настройках игры">?</button>
        <button id="close-game-btn" class="gbtn">✖</button>
      </div>
    </div>
    <iframe id="game-iframe" src="" title="Game iframe"></iframe>
  </div>

  <!-- --- Модальное окно справки --- -->
  <div id="help-modal">
    <div id="help-content">
      <h2>Инструкция</h2>
      <p><b>Вкладки:</b> ТВ, РАДИО, ИГРЫ — переключают режим интерфейса.</p>
      <p><b>РАДИО:</b> выберите станцию и вручную нажмите Play, если автозапуск не сработал.</p>
      <p><b>ИГРЫ:</b> выберите игру из списка. Кнопки управления окном игры:</p>
      <ul>
        <li>▽ — свернуть</li>
        <li>△ — восстановить</li>
        <li>❏ — во весь экран</li>
        <li>✖ — закрыть игру</li>
      </ul>
      <p><b>Горячие клавиши:</b></p>
      <ul>
        <li>1 = ТВ</li>
        <li>2 = РАДИО</li>
        <li>3 = ИГРЫ</li>
        <li>Escape = закрыть окно, игру, справку</li>
      </ul>
      <button id="close-help">Закрыть</button>
    </div>
  </div>

  <div id="bottom-text">
    Интерфейс ТВ/РАДИО/ИГРЫ — Придумал, сделал. MUZER play.
  </div>

  <!-- VK Bridge -->
  <script src="https://unpkg.com/@vkontakte/vk-bridge/dist/browser.min.js"></script>
  <script>
    // Инициализация VK Bridge для интеграции с VK Mini Apps
    (async () => {
      try {
        await vkBridge.send('VKWebAppInit');
      } catch (e) {
        console.warn('VK Bridge initialization failed or unavailable', e);
      }
    })();
  </script>

  <!-- Основной JS функционал -->
  <script>
    /* --- Данные радиостанций и игр --- */
    const RADIO_CHANNELS = [
{ name: "Европа плюс", url: "https://ep256.hostingradio.ru:8052/europaplus256.mp3" },
{ name: "Радио Рекорд", url: "https://radiorecord.hostingradio.ru/rr_main96.aacp" },
{ name: "Наше радио", url: "https://nashe1.hostingradio.ru/nashe-256" },
{ name: "Авторадио", url: "https://pub0101.101.ru/stream/air/aac/64/100" },
{ name: "Радио Energy", url: "https://pub0202.101.ru:8443/stream/air/aac/64/99" },
{ name: "Kiss FM", url: "https://radiopotok2.online/http://online.kissfm.ua/KissFM_HD" },
{ name: "Ретро ФМ", url: "https://retro.hostingradio.ru:8043/retro256.mp3" },
{ name: "Русское радио", url: "https://rusradio.hostingradio.ru/rusradio96.aacp" },
{ name: "Маруся ФМ", url: "https://cdn.radio-holding.ru/marusya_default" },
{ name: "Record Russian Mix", url: "https://radiorecord.hostingradio.ru/rus96.aacp" },
{ name: "Радио Максимум", url: "https://maximum.hostingradio.ru/maximum96.aacp" },
{ name: "Ретро Хит", url: "https://retro.amgradio.ru/Retro?r_bells" },
{ name: "Пиратская станция", url: "https://radiorecord.hostingradio.ru/ps96.aacp" },
{ name: "ROCK FM", url: "https://nashe1.hostingradio.ru/rock-128.mp3" },
{ name: "Хит FM", url: "https://hitfm.hostingradio.ru/hitfm96.aacp" },
{ name: "Юмор FM", url: "https://pub0302.101.ru:8443/stream/air/aac/64/102" },
{ name: "Супердискотека 90-х", url: "https://radiorecord.hostingradio.ru/sd9096.aacp" },
{ name: "90s Eurodance", url: "https://listen1.myradio24.com/5967" },
{ name: "Enigmatic Station 3", url: "https://radio.enigmatic.su:8005/radio" },
{ name: "DFM Дискач 90-ых", url: "https://dfm-disc90.hostingradio.ru/disc9096.aacp" },
{ name: "Record Megamix", url: "https://radiorecord.hostingradio.ru/mix96.aacp" },
{ name: "Россия 90-ых", url: "https://pub0102.101.ru:8443/stream/pro/aac/64/33" },
{ name: "Record Future House", url: "https://radiorecord.hostingradio.ru/fut96.aacp" },
{ name: "Радио СССР 50-70", url: "https://pub0302.101.ru:8000/stream/pro/aac/64/47?" },
{ name: "Родные Песни", url: "https://rodpesni.amgradio.ru/rp?r_bells" },
{ name: "Рок Арсенал", url: "https://online.rockarsenal.ru/rockwotalk" },
{ name: "Дискотека 90-ых", url: "https://pub0302.101.ru:8443/stream/pro/aac/64/74" },
{ name: "PromoDJ Strange", url: "https://radio.promodj.com/strange-192" },
{ name: "The Disco Palace Radio", url: "https://broadcast.miami/proxy/thediscopalace?mp=/stream/" },
{ name: "Dancing Fox", url: "https://stream.cassiopeia-station.ru:1135/stream" },
{ name: "Милицейская волна", url: "https://radiomv.hostingradio.ru:80/radiomv128.mp3" },
{ name: "Хит FM Хит 2000-х", url: "https://hitfm-hit2000.hostingradio.ru/hit200096.aacp" },
{ name: "Record Gold", url: "https://radiorecord.hostingradio.ru/gold96.aacp" },
{ name: "RockTime Radio", url: "https://listen.myrh.ru/rocktimeradio" },
{ name: "NRJ Techno", url: "https://pub0202.101.ru:8000/stream/trust/mp3/128/18?" },
{ name: "Remix FM", url: "https://rmx.amgradio.ru/RemixFM?r_bells" },
{ name: "Русский шансон 24", url: "https://stream.vyshka24.ru/russhanson24" },
{ name: "Русские песни", url: "https://rusongs.amgradio.ru/rusongs?r_bells" },
{ name: "Sector Next  / 90s", url: "https://radiopotok2.online/http://89.223.45.5:8000/next-160" },
{ name: "Шансон Радио", url: "https://listen7.myradio24.com/75853" },
{ name: "Радио Калейдоскоп: Шансон", url: "https://listen7.myradio24.com/22602" },
{ name: "Хорошее радио", url: "https://hr.amgradio.ru/Horoshee?r_bells" },
{ name: "Happy Radio", url: "https://stream-38.zeno.fm/nkeaps48xg0uv?" },
{ name: "PRO Dj Radio", url: "https://live.prodjradio.net:8065/radio" },
{ name: "Russian Deep Radio", url: "https://radiopotok2.online/http://radio.rudeep.ru:8000/stream" },
{ name: "PromoDJ Top100", url: "https://radio.promodj.com/top100-192" },
{ name: "Record Dream Dance", url: "https://radiorecord.hostingradio.ru/dream96.aacp" },
{ name: "PromoDJ POP", url: "https://radio.promodj.com/pop-192" },
{ name: "NRJ Dance", url: "https://pub0302.101.ru:8000/stream/pro/aac/64/443?" },
{ name: "Record Russian Hits", url: "https://radiorecord.hostingradio.ru/russianhits96.aacp" },
{ name: "Record House Classics", url: "https://radiorecord.hostingradio.ru/houseclss96.aacp" }
    ];
    const GAMES = [
     { name: "1. Gary's World", url: "https://igroutka.ru/loader/game/39304/" },
  { name: "2. Super Mario Jungle Run Adventure", url: "https://html5.gamemonetize.co/bvcjf1q6fperpbo46nltza3se8557ev5/" },
  { name: "3. Марио в Египте", url: "https://igroutka.ru/loader/game/34138/" },
  { name: "4. Super Peaman World", url: "https://igroutka.ru/loader/game/40572/" },
  { name: "5. Super Mario Wonder", url: "https://html5.gamemonetize.co/zk99zkldgfzm89l2g56hhf5rfzitm9x8/" },
  { name: "6. Черепашки Ниндзя: Олд Скул", url: "https://igroutka.ru/loader/game/16938/" },
  { name: "7. Кража со взломом", url: "https://igroutka.ru/loader/game/16939/" },
  { name: "8. Битва героев", url: "https://igroutka.ru/loader/game/16976/" },
  { name: "9. Мир Супер Схваток", url: "https://igroutka.ru/loader/game/16977/" },
  { name: "10. Cuphead Rush", url: "https://igroutka.ru/loader/game/30464/" },
  { name: "11. Свободное Падение", url: "https://igroutka.ru/loader/game/18788/" },
  { name: "12. Сырный Рывок", url: "https://igroutka.ru/loader/game/48433/" },
  { name: "13. Tom Runner", url: "https://igroutka.ru/loader/game/28211/" },
  { name: "14. sonic run adventure", url: "https://igroutka.ru/loader/game/33661/" },
  { name: "15. Соник: Утечка в Лабиринте", url: "https://igroutka.ru/loader/game/31923/" },
  { name: "16. Hyperplex 3D", url: "https://igroutka.ru/loader/game/30401/" },
  { name: "17. Пещерный Гольф", url: "https://igroutka.ru/loader/game/20141/" },
  { name: "18. Пещерный Хаос", url: "https://igroutka.ru/loader/game/37223/" },
  { name: "19. Бег На Бочке", url: "https://igroutka.ru/loader/game/30561/" },
  { name: "20. Воришка Боб 4", url: "https://igroutka.ru/loader/game/21411/" },
  { name: "21. Гонка Ллойда", url: "https://igroutka.ru/loader/game/23945/" },
  { name: "22. Мотоциклы: Сложные Трассы", url: "https://igroutka.ru/loader/game/30540/" },
  { name: "23. Crazy Ball Adventures", url: "https://www.onlinegames.io/games/2021/unity2/crazy-ball-adventures/index.html" },
  { name: "24. Cross The Road", url: "https://www.onlinegames.io/games/2023/unity/cross-the-road/index.html" },
  { name: "25. Motorbike Traffic", url: "https://www.onlinegames.io/games/2021/unity/motorbike-traffic/index.html" },
  { name: "26. ATV Highway Traffic", url: "https://www.onlinegames.io/games/2021/unity/atv-highway-traffic/index.html" },
  { name: "27. Traffic Tour", url: "https://traffictour.github.io/traffic-tour/" },
  { name: "28. Drift Rider", url: "https://www.onlinegames.io/games/2023/unity3/drift-rider/index.html" },
  { name: "29. Drift Hunters Pro", url: "https://www.onlinegames.io/games/2023/unity/drift-hunters-pro/index.html" },
  { name: "30. Fort Drifter", url: "https://www.onlinegames.io/games/2022/unity3/fort-drifter/index.html" },
  { name: "31. Crazy Drifter", url: "https://www.onlinegames.io/games/2022/unity3/crazy-drifter/index.html" },
  { name: "32. Redball Avengers", url: "https://html5.gamemonetize.co/3c126lglzfi8k0doec3jwdcrldt7jg4p/" },
  { name: "33. Space Shooter Boss", url: "https://html5.gamemonetize.co/vfjh5lqrh92fxoxfesnyrvzm099zlymo/" },
  { name: "34. Neon Ball Slope", url: "https://html5.gamemonetize.co/tvffgv3xt5p39edpb54kiulbaa86ia21/" },
  { name: "35. Dino run run", url: "https://html5.gamemonetize.co/juv3z888inp5zrbvpgwiu86qbefya3sx/" },
  { name: "36. Tung Tung Super Sahur", url: "https://html5.gamemonetize.co/9qhkcbj9l8glrzox8fjdyqnnifybia7m/" }
    ];

    /* --- Получаем DOM элементы --- */
    const btnTV = document.getElementById('btn-tv');
    const btnRadio = document.getElementById('btn-radio');
    const btnGames = document.getElementById('btn-games');
    const tvContainer = document.getElementById('tv-iframe-container');
    const radioPlayer = document.getElementById('radio-player');
    const radioAudio = document.getElementById('radio-audio');
    const channelsDiv = document.getElementById('channels');
    const gamesOverlay = document.getElementById('games-overlay');
    const gamesList = document.getElementById('games-list');
    const gameWindow = document.getElementById('game-window');
    const gameIframe = document.getElementById('game-iframe');
    const gameTitle = document.getElementById('game-title');
    const minimizeBtn = document.getElementById('minimize-btn');
    const restoreBtn = document.getElementById('restore-btn');
    const fsEnter = document.getElementById('fs-enter');
    const fsExit = document.getElementById('fs-exit');
    const closeGameBtn = document.getElementById('close-game-btn');
    const helpBtn = document.getElementById('help-main-btn');
    const helpModal = document.getElementById('help-modal');
    const closeHelp = document.getElementById('close-help');

    let selectedChannelUrl = null; // хранит URL текущего радио

    /* --- Функция для установки активной вкладки --- */
    function setActiveButton(button) {
      [btnTV, btnRadio, btnGames].forEach(b => b.classList.toggle('active', b === button));
    }

    /* --- События на вкладки --- */
    btnTV.addEventListener('click', () => {
      setActiveButton(btnTV);
      tvContainer.style.display = 'block';
      radioPlayer.style.display = 'none';
      stopRadioAudio();
      gamesOverlay.style.display = 'none';
      closeGame();
    });
    btnRadio.addEventListener('click', () => {
      setActiveButton(btnRadio);
      radioPlayer.style.display = 'flex';
      tvContainer.style.display = 'none';
      gamesOverlay.style.display = 'none';
      if (selectedChannelUrl) radioAudio.style.display = 'inline-block';
    });
    btnGames.addEventListener('click', () => {
      setActiveButton(btnGames);
      gamesOverlay.style.display = 'flex';
      tvContainer.style.display = 'none';
      radioPlayer.style.display = 'none';
    });

    /* --- Функции для отображения каналов и игр --- */
    function renderChannels() {
      channelsDiv.innerHTML = '';
      RADIO_CHANNELS.forEach((ch, idx) => {
        const btn = document.createElement('button');
        btn.className = 'channel';
        btn.textContent = `${idx + 1}. ${ch.name}`;
        btn.title = ch.name;
        btn.addEventListener('click', () => selectChannel(ch));
        btn.dataset.url = ch.url;
        channelsDiv.appendChild(btn);
      });
    }
    function renderGames() {
      gamesList.innerHTML = '';
      GAMES.forEach((g, idx) => {
        const btn = document.createElement('button');
        btn.className = 'game-item';
        btn.textContent = `${idx + 1}. ${g.name}`;
        btn.title = g.name;
        btn.addEventListener('click', () => openGame(g));
        gamesList.appendChild(btn);
      });
    }

    /* --- Выбор радиостанции --- */
    function selectChannel(channel) {
      selectedChannelUrl = channel.url;
      Array.from(channelsDiv.children).forEach(btn =>
        btn.classList.toggle('selected', btn.dataset.url === channel.url)
      );
      radioAudio.src = channel.url;
      radioAudio.style.display = 'inline-block';
      try { radioAudio.play(); } catch {}
    }

    function stopRadioAudio() {
      try {
        radioAudio.pause();
        radioAudio.currentTime = 0;
        radioAudio.src = '';
      } catch (e) {}
    }

    /* --- Управление окном игры --- */
    function openGame(game) {
      gameTitle.textContent = game.name;
      gameIframe.src = game.url;
      gameWindow.style.display = 'block';
      gameWindow.setAttribute('aria-hidden', 'false');
      gameWindow.classList.remove('minimized', 'fullscreen');
      restoreBtn.style.display = 'none';
      minimizeBtn.style.display = 'inline-block';
      fsEnter.style.display = 'inline-block';
      fsExit.style.display = 'none';
    }
    minimizeBtn.addEventListener('click', () => {
      gameWindow.classList.add('minimized');
      minimizeBtn.style.display = 'none';
      restoreBtn.style.display = 'inline-block';
    });
    restoreBtn.addEventListener('click', () => {
      gameWindow.classList.remove('minimized');
      restoreBtn.style.display = 'none';
      minimizeBtn.style.display = 'inline-block';
    });
    fsEnter.addEventListener('click', async () => {
      if (gameWindow.requestFullscreen) {
        try {
          await gameWindow.requestFullscreen();
          gameWindow.classList.add('fullscreen');
          fsEnter.style.display = 'none';
          fsExit.style.display = 'inline-block';
        } catch (e) { console.warn('Fullscreen failed', e); }
      } else {
        gameWindow.classList.add('fullscreen');
        fsEnter.style.display = 'none';
        fsExit.style.display = 'inline-block';
      }
    });
    fsExit.addEventListener('click', async () => {
      if (document.fullscreenElement) {
        try {
          await document.exitFullscreen();
          gameWindow.classList.remove('fullscreen');
          fsEnter.style.display = 'inline-block';
          fsExit.style.display = 'none';
        } catch (e) { console.warn('Exit fullscreen failed', e); }
      } else {
        gameWindow.classList.remove('fullscreen');
        fsEnter.style.display = 'inline-block';
        fsExit.style.display = 'none';
      }
    });
    closeGameBtn.addEventListener('click', () => { closeGame(); });
    function closeGame() {
      gameWindow.style.display = 'none';
      gameWindow.classList.remove('minimized', 'fullscreen');
      gameWindow.setAttribute('aria-hidden', 'true');
      try { gameIframe.src = ''; } catch (e) {}
    }

    /* --- Модальное окно справки --- */
    helpBtn.addEventListener('click', () => { helpModal.style.display = 'flex'; });
    closeHelp.addEventListener('click', () => { helpModal.style.display = 'none'; });

    /* --- Горячие клавиши --- */
    document.addEventListener('keydown', (e) => {
      if (e.key === '1') btnTV.click();
      if (e.key === '2') btnRadio.click();
      if (e.key === '3') btnGames.click();
      if (e.key === 'Escape') {
        closeGame();
        helpModal.style.display = 'none';
        if (gamesOverlay.style.display === 'flex') gamesOverlay.style.display = 'none';
      }
    });

    /* --- Инициализация интерфейса --- */
    renderChannels();
    renderGames();
  </script>
</body>
</html>


